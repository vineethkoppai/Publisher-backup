(function(e){e.fn.fixheadertable=function(t){function r(e,t){if(e.currentStyle){var n=x.currentStyle[t]}else if(window.getComputedStyle){var n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}return n}function i(){var t=e("<p/>").addClass("t_fixed_header_scroll_inner");var n=e("<div/>").addClass("t_fixed_header_scroll_outer");n.append(t);e(document.body).append(n);var r=t[0].offsetWidth;n.css("overflow","scroll");var i=t[0].offsetWidth;if(r==i)i=n[0].clientWidth;n.remove();return r-i}function s(t,n){var r={m:1,d:1,y:1970,h:0,i:0,s:0},i,s,o;if(n&&n!==null&&n!==undefined){n=e.trim(n);n=n.split(/[\\\/:_;.\t\T\s-]/);t=t.split(/[\\\/:_;.\t\T\s-]/);var u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"];var a=["am","pm","AM","PM"];var f=function(e,t){if(e===0){if(t==12){t=0}}else{if(t!=12){t+=12}}return t};for(i=0,s=t.length;i<s;i++){if(t[i]=="M"){o=e.inArray(n[i],u);if(o!==-1&&o<12){n[i]=o+1}}if(t[i]=="F"){o=e.inArray(n[i],u);if(o!==-1&&o>11){n[i]=o+1-12}}if(t[i]=="a"){o=e.inArray(n[i],a);if(o!==-1&&o<2&&n[i]==a[o]){n[i]=o;r.h=f(n[i],r.h)}}if(t[i]=="A"){o=e.inArray(n[i],a);if(o!==-1&&o>1&&n[i]==a[o]){n[i]=o-2;r.h=f(n[i],r.h)}}if(n[i]!==undefined){r[t[i].toLowerCase()]=parseInt(n[i],10)}}r.m=parseInt(r.m,10)-1;var l=r.y;if(l>=70&&l<=99){r.y=1900+r.y}else if(l>=0&&l<=69){r.y=2e3+r.y}}return new Date(r.y,r.m,r.d,r.h,r.i,r.s,0)}var n={caption:"",showhide:true,theme:"ui",height:null,width:null,minWidth:null,minWidthAuto:false,colratio:[],whiteSpace:"nowrap",addTitles:false,zebra:false,zebraClass:"ui-state-active",sortable:false,sortedColId:null,sortType:[],dateFormat:"d-m-y",pager:false,rowsPerPage:10,resizeCol:false,minColWidth:100,wrapper:true};var t=e.extend(n,t);return this.each(function(){function C(t){l=e('<div class="headtable ui-state-default" style="margin-right : 0px"></div>');f=l;f.insertBefore(t)}function k(r){var i=e("<colgroup />");if(t.colratio.length==0){var s=null;for(var o=0;o<r;o++){s=e('<col style="width : '+100/r+'%" />');i.append(s);s=null}}else if(t.colratio.length==r){var u=0;for(var o=0;o<r;o++){s=e('<col style="width : '+t.colratio[o]+'px" />');i.append(s);s=null;u+=parseInt(t.colratio[o])}e(n).css("width",u+"px")}return i}function L(n,r,i,u){if(t.sortType.length!=0&&t.sortType.length==o){var a=t.sortType[r];if(a=="float"){getSortKey=function(e){var t=parseFloat(String(e).replace(x,""));return isNaN(t)?0:t}}else if(a=="integer"){getSortKey=function(e){return e?parseFloat(String(e).replace(x,"")):0}}else if(a=="date"){getSortKey=function(e){return s(t.dateFormat,e).getTime()}}else{getSortKey=function(t){if(!t){t=""}return e.trim(String(t).toLowerCase())}}}else{getSortKey=function(t){if(!t){t=""}return e.trim(String(t).toLowerCase())}}S.sort(function(e,t){var n=getSortKey(e[r]);var i=getSortKey(t[r]);return n<i?-1:n>i?1:0});if(i=="DESC"){S.reverse()}t.pager?I(n):A(S,n)}function A(n,r){var i=e("tbody",r);i.children().remove();if(t.zebra){for(var s=0;s<n.length;s++){s%2?tr=e('<tr class="'+t.zebraClass+'"></tr>'):tr=e("<tr></tr>");for(var o in n[s]){tr.append(e('<td class="ui-widget-content"></td>').html(n[s][o]))}i.append(tr)}}else{for(var s=0;s<n.length;s++){tr=e("<tr></tr>");for(var o in n[s]){tr.append(e('<td class="ui-widget-content"></td>').html(n[s][o]))}i.append(tr)}}}function O(t){var n=[];e("tr",t).each(function(t){var r={};e("td",this).each(function(t){r[t]=e(this).html()});n.push(r)});return n}function M(r){h=e('<table class="head"/>').append(d).append(e("thead",r));f.append(h);h.wrap("<div></div>");var i=e("th",h);i.addClass("ui-widget-content ui-state-default table-header");if(t.sortable){var s=null;i.each(function(t){e(this).contents().wrapAll('<div class="ui-sort"></div>');s=e("div.ui-sort",this);s.click(function(){i.removeClass("ui-state-hover");e(this).parent().removeClass("ui-state-active").addClass("ui-state-hover");e("span.ui-icon",i).remove();if(e(this).hasClass("sortedUp")){L(r,t,"DESC",this);e(this).removeClass("sortedUp").addClass("sortedDown");e(this).append('<span style="display : inline-block; vertical-align : middle" class="ui-icon ui-icon-triangle-1-s"></span>')}else{L(r,t,"ASC",this);e(this).removeClass("sortedDown").addClass("sortedUp");e(this).append('<span style="display : inline-block; vertical-align : middle" class="ui-icon ui-icon-triangle-1-n"></span>')}f[0].scrollLeft=c[0].scrollLeft})});e("div.ui-sort",i).addClass("hover")}if(t.resizeCol&&t.colratio.length==o){i.each(function(t){var n=e('<span class="ui-resize"></span>');e(this).prepend(n);n.mousedown(function(e){a(t,e);return false})});_main_wrapper.mousemove(function(e){if(T){l(e);return false}}).mouseup(function(){if(T){p();return false}return true});function u(t){var n=0,r=e("col",d),i=e("th > span.ui-resize",h)[t],s=c[0].scrollLeft;for(var o=0;o<t;o++){n+=parseInt(r[o].style.width)}return i.offsetLeft+5+n-s}function a(e,t){T={id:e,startX:t.clientX,initTableWidth:U(),offset:u(e)};N.css({display:"block",height:f.height()+c.height()+2+"px",left:T.offset+"px",cursor:"col-resize"})}function l(n){var r=n.clientX-T.startX;T.newWidth=parseInt(e("col",d)[T.id].style.width)+r;T.newTableWidth=T.initTableWidth+r;if(T.newWidth>parseInt(t.minColWidth)){N.css({left:T.offset+r+"px"})}else{T.newWidth=parseInt(t.minColWidth)}}function p(){e(d.children()[T.id]).css({width:T.newWidth+"px"});e(v.children()[T.id]).css({width:T.newWidth+"px"});var t=T.newTableWidth;h.css({width:t+"px"});e(n).css({width:t+"px"});T=null;N.css({display:"none"});f[0].scrollLeft=c[0].scrollLeft}}}function _(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var e=new Number(RegExp.$1);if(e==7||e==6){return true}else{return false}}}function D(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var e=new Number(RegExp.$1);if(e==8){return true}else{return false}}}function P(n){c=e('<div class="body ui-widget-content"></div>').insertBefore(n).append(n);if(t.height!=null&&!isNaN(parseInt(t.height))){c.css("height",t.height+"px")}v=d.clone();e(n).prepend(v);e("td",n).addClass("ui-widget-content table-row");e(n).wrap("<div></div>");if(t.addTitles==true){e("td",n).each(function(){e(this).attr("title",e(this).text())})}if(t.zebra){e("tr:odd",n).addClass(t.zebraClass)}}function H(n){var r=p;if(_()){r=0}var i=0;if(parseInt(e(n).height())>parseInt(t.height)){i=r;overflow="scroll"}else{i=0;overflow="auto"}if(e.browser.msie&&t.height){i=r;overflow="scroll"}l.css("margin-right",i);return overflow}function B(t,n){var r=S.length;var i=0;if(r<n){i=r}else{i=n}var s=S.slice(0,i);A(s,t);y=Math.ceil(r/n);w=1;b.html("Showing page "+w+" of "+y);c.css("overflow-y",H(t));e("tr:last td",t).css("border-bottom-width","1px")}function j(e){w++;if(w>=y){w=y}I(e)}function F(e){w--;if(w<=1){w=1}I(e)}function I(t){var n=S.length;var r,i=0;r=(w-1)*g;if(n<w*g){i=n}else{i=w*g}var s=S.slice(r,i);A(s,t);b.html("Showing page "+w+" of "+y);c.css("overflow-y",H(t));e("tr:last td",t).css("border-bottom-width","1px")}function q(t,n,r){var i=e('<div class="button ui-state-default '+r+'"><span class="ui-icon '+t+'"> </span></div>');E.append(i);i.mouseover(function(){e(this).addClass("ui-state-hover")}).mousedown(function(){e(this).addClass("ui-state-active")}).mouseup(function(){e(this).removeClass("ui-state-active")}).mouseout(function(){e(this).removeClass("ui-state-active");e(this).removeClass("ui-state-hover")}).click(n)}function R(n){E=e('<div class="pager ui-widget-header ui-corner-bottom ui-widget-content"></div>');_main_wrapper.append(E);q("ui-icon-arrowthickstop-1-e",function(){w=y;I(n)},"ui-corner-right");q("ui-icon ui-icon-arrowthick-1-e",function(){j(n)},"noborder");q("ui-icon ui-icon-arrowthick-1-w",function(){F(n)},"noborder");q("ui-icon-arrowthickstop-1-w",function(){w=1;I(n)},"ui-corner-left noborder");_button_set=e('<div id="'+n.id+'_radio" style="float : left">'+'<input type="radio" id="'+n.id+'_show_10_rows" name="'+n.id+'_radio"/><label for="'+n.id+'_show_10_rows">10</label>'+'<input type="radio" id="'+n.id+'_show_25_rows" name="'+n.id+'_radio"/><label for="'+n.id+'_show_25_rows">25</label>'+'<input type="radio" id="'+n.id+'_show_50_rows" name="'+n.id+'_radio" /><label for="'+n.id+'_show_50_rows">50</label>'+'<input type="radio" id="'+n.id+'_show_100_rows" name="'+n.id+'_radio"/><label for="'+n.id+'_show_100_rows">100</label>'+"</div>");E.append(_button_set);e("#"+n.id+"_show_10_rows",E).click(function(){g=m;B(n,g)});e("#"+n.id+"_show_25_rows",E).click(function(){g=m*2.5;B(n,g)});e("#"+n.id+"_show_50_rows",E).click(function(){g=m*5;B(n,g)});e("#"+n.id+"_show_100_rows",E).click(function(){g=m*10;B(n,g)});b=e('<div class="page_infos"></div>');E.append(b);g=m;e("#"+n.id+"_show_"+t.rowsPerPage+"_rows",E).click();_button_set.buttonset()}function U(){var e=0;for(var n=0;n<t.colratio.length;n++){e+=parseInt(t.colratio[n])}return e}var n=e(this);var r=null;var o=e("thead th",this).length;var u=e(this).width();var a=null;var f=null;var l=null;var c=null;var h=null;var p=i();var d=k(o);var v=null;var m=10;var g=null;var y=null;var b=null;var w=null;var E=null;var S=null;var x=/[\$,%]/g;var T=null;var N=null;a=e("<div/>").addClass("t_fixed_header ui-state-default default "+t.theme).insertBefore(this).append(this);a.css("border","none").css("font-weight","normal");_main_wrapper=e('<div class="t_fixed_header_main_wrapper ui-widget ui-widget-header '+t.theme+'"></div>');if(t.whiteSpace=="normal"){a.addClass("t_fixed_header_wrap")}C(this);M(this);P(this);if(t.wrapper){var z=a.wrap('<div class="ui-widget ui-widget-content ui-corner-all" style="padding : 5px; font-size : 1em;"></div>').parent()}else{var z=a.wrap("<div></div>").parent()}if(t.width!=null&&!isNaN(parseInt(t.width))&&t.width>0){z.css("width",t.width+"px")}var W=a.detach();var X=e('<div class="t_fixed_header_main_wrapper_child"></div>');_main_wrapper.append(X);X.append(W);z.append(_main_wrapper);if(_()){c.css("margin-bottom",17+"px")}if(t.caption!=""){var V=e('<div class="t_fixed_header_caption ui-widget-header ui-corner-top">'+t.caption+"</div>");_main_wrapper.prepend(V).addClass("ui-corner-all");if(t.showhide){var J=e('<div style="cursor : pointer; display : inline-block; vertical-align : middle; background : none; border : none;" class="ui-state-active"><span class="ui-icon ui-icon-triangle-1-n"> </span></div>');V.append(J);J.click(function(){X.toggle();V.toggleClass("toggle");if(E)E.toggle();e("span",J).toggleClass("ui-icon-triangle-1-s")})}}if(t.sortable||t.pager){S=O(this)}if(t.pager){R(this)}if(t.sortable&&!isNaN(parseInt(t.sortedColId))){var K=e("th",h)[t.sortedColId];e(K).addClass("ui-state-hover");e("div.ui-sort",K).click()}if(t.resizeCol&&t.colratio.length==o){N=e('<div class="ui-resize-ghost ui-widget-header" style="height : '+_main_wrapper.parent().height()+'px"></div>');a.append(N)}c.css("overflow-y",H(this));if(t.minWidth!=null&&!isNaN(parseInt(t.minWidth))&&t.minWidth>0){var Q=t.minWidth+"px"}else if(t.minWidthAuto){if(t.colratio.length==o){var Q=e(this).width()+"px"}else{var Q=u+150+"px"}}f.children().first().css("min-width",Q);c.children().first().css("min-width",Q);c.scroll(function(){f[0].scrollLeft=c[0].scrollLeft});if(t.colratio.length==o){a.removeClass("default");e(h).css("width",U()+"px")}})}})(jQuery)